<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    

    
<script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("use-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script>
    

<meta charset="utf-8" >

<title>itextpdf+thymeleaf实现html转pdf</title>
<meta name="keywords" content="itextpdf+thymeleaf实现html转pdf, 万物天空">
<meta name="description" content="业务需求项目需要用到导出pdf格式的列表，正常情况下是导出excel表格的，但是产品要求要导出pdf，组长叫我尝试一下itextpdf和thymeleaf。捣鼓了几天研究出来了，但是还没有具体运用上线。
教程最终效果如下图
准备POM依赖先">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="itextpdf+thymeleaf实现html转pdf">
<meta property="og:description" content="业务需求项目需要用到导出pdf格式的列表，正常情况下是导出excel表格的，但是产品要求要导出pdf，组长叫我尝试一下itextpdf和thymeleaf。捣鼓了几天研究出来了，但是还没有具体运用上线。
教程最终效果如下图
准备POM依赖先">

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style/main.css">

  <link rel="stylesheet" href="/style/simple-lightbox.min.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="万物天空" type="application/atom+xml">
</head>
  <body>
    <div id="app" class="main">

<div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://www.loveasd.com">
        <img class="avatar" src="/images/avatar.png" alt="logo" width="32px" height="32px">
      </a>
      <a href="https://www.loveasd.com">
        <h1 class="site-title">万物天空</h1>
      </a>
    </div>
    <div class="right">
        <i class="icon menu-switch icon-menu-outline" ></i>
    </div>
  </div>
</div>

<div class="menu-container" style="height: 0;opacity: 0;">
<nav class="menu-list">
  
    
      <a href="/" class="menu purple-link">
        首页
      </a>
    
  
    
      <a href="/tags" class="menu purple-link">
        标签
      </a>
    
  
    
      <a href="/archives" class="menu purple-link">
        归档
      </a>
    
  
    
      <a href="/about" class="menu purple-link">
        关于
      </a>
    
  
</nav>
</div>



  <div class="content-container">
    <div class="post-detail">
      
      <h2 class="post-title">itextpdf+thymeleaf实现html转pdf</h2>
      <div class="post-info post-detail-info">
        <span><i class="icon icon-calendar-outline"></i> 2024-05-10</span>
        
          <span>
          <i class="icon icon-pricetags-outline"></i>
            
              <a href="/tags/itextpdf/">
              itextpdf
                
                  ，
                
              </a>
            
              <a href="/tags/thymeleaf/">
              thymeleaf
                
                  ，
                
              </a>
            
              <a href="/tags/html2pdf/">
              html2pdf
                
              </a>
            
          </span>
        
      </div>
      <div class="post-content-wrapper">
        <div class="post-content">
          <h2 id="业务需求"><a href="#业务需求" class="headerlink" title="业务需求"></a>业务需求</h2><p>项目需要用到导出pdf格式的列表，正常情况下是导出excel表格的，但是产品要求要导出pdf，组长叫我尝试一下itextpdf和thymeleaf。<br>捣鼓了几天研究出来了，但是还没有具体运用上线。</p>
<h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><p>最终效果如下图<br><a class="simple-lightbox" target="_blank" rel="noopener" href="https://loveasd-oss.s3.us-east-005.backblazeb2.com/loveasd-oss/2024/05/pdf2html-1.png"><img   src="/images/loading.svg" data-src="https://loveasd-oss.s3.us-east-005.backblazeb2.com/loveasd-oss/2024/05/pdf2html-1.png"  alt="效果图" lazyload></a></p>
<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><h3 id="POM依赖"><a href="#POM依赖" class="headerlink" title="POM依赖"></a>POM依赖</h3><p>先导入相关的pom依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- itext7html转pdf  --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;html2pdf&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">3.0</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 中文字体支持 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;font-asian&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">7.1</span><span class="number">.13</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--freemarker模板--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;cn.hutool&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">5.8</span><span class="number">.16</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h3><p>这里主要是加一些适配器，比如页眉、页码、水印等</p>
<h4 id="页眉相关"><a href="#页眉相关" class="headerlink" title="页眉相关"></a>页眉相关</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeaderH</span> <span class="keyword">implements</span> <span class="title class_">IEventHandler</span> &#123;</span><br><span class="line">    String header;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HeaderH</span><span class="params">(String header)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.header = header;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleEvent</span><span class="params">(Event event)</span> &#123;</span><br><span class="line">        <span class="type">PdfDocumentEvent</span> <span class="variable">docEvent</span> <span class="operator">=</span> (PdfDocumentEvent) event;</span><br><span class="line">        <span class="type">PdfDocument</span> <span class="variable">pdf</span> <span class="operator">=</span> docEvent.getDocument();</span><br><span class="line">        <span class="type">PdfPage</span> <span class="variable">page</span> <span class="operator">=</span> docEvent.getPage();</span><br><span class="line">        <span class="keyword">if</span> (pdf.getPageNumber(page) == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">Rectangle</span> <span class="variable">pageSize</span> <span class="operator">=</span> page.getPageSize();</span><br><span class="line">        <span class="type">PdfCanvas</span> <span class="variable">pdfCanvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfCanvas</span>(</span><br><span class="line">            page.getLastContentStream(), page.getResources(), pdf);</span><br><span class="line">        <span class="type">Canvas</span> <span class="variable">canvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Canvas</span>(pdfCanvas, pdf, pageSize);</span><br><span class="line">        canvas.showTextAligned(header,</span><br><span class="line">            pageSize.getWidth() / <span class="number">2</span>,</span><br><span class="line">            pageSize.getTop() - <span class="number">30</span>, TextAlignment.CENTER);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="页码"><a href="#页码" class="headerlink" title="页码"></a>页码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageXofY</span> <span class="keyword">implements</span> <span class="title class_">IEventHandler</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> PdfFormXObject placeholder;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> totalPageCount;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> <span class="variable">side</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">750</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> <span class="variable">y</span> <span class="operator">=</span> <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> <span class="variable">space</span> <span class="operator">=</span> <span class="number">4.5f</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">float</span> <span class="variable">descent</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PageXofY</span><span class="params">(PdfDocument pdf, <span class="type">int</span> totalPageCount)</span> &#123;</span><br><span class="line">        placeholder =</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">PdfFormXObject</span>(<span class="keyword">new</span> <span class="title class_">Rectangle</span>(<span class="number">0</span>, <span class="number">0</span>, side, side));</span><br><span class="line">        <span class="built_in">this</span>.totalPageCount = totalPageCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleEvent</span><span class="params">(Event event)</span> &#123;</span><br><span class="line">        <span class="type">PdfDocumentEvent</span> <span class="variable">docEvent</span> <span class="operator">=</span> (PdfDocumentEvent) event;</span><br><span class="line">        <span class="type">PdfDocument</span> <span class="variable">pdf</span> <span class="operator">=</span> docEvent.getDocument();</span><br><span class="line">        <span class="type">PdfPage</span> <span class="variable">page</span> <span class="operator">=</span> docEvent.getPage();</span><br><span class="line">        <span class="type">int</span> <span class="variable">pageNumber</span> <span class="operator">=</span> pdf.getPageNumber(page);</span><br><span class="line">        <span class="type">Rectangle</span> <span class="variable">pageSize</span> <span class="operator">=</span> page.getPageSize();</span><br><span class="line">        <span class="type">PdfCanvas</span> <span class="variable">pdfCanvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfCanvas</span>(</span><br><span class="line">                page.getLastContentStream(), page.getResources(), pdf);</span><br><span class="line">        <span class="type">Canvas</span> <span class="variable">canvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Canvas</span>(pdfCanvas, pdf, pageSize);</span><br><span class="line">        <span class="type">Paragraph</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Paragraph</span>()</span><br><span class="line">                .add(<span class="string">&quot;Page&quot;</span>)</span><br><span class="line">                .add(String.valueOf(StrPool.C_SPACE))</span><br><span class="line">                .add(String.valueOf(pageNumber))</span><br><span class="line">                .add(String.valueOf(StrPool.C_SPACE))</span><br><span class="line">                .add(<span class="string">&quot;of&quot;</span>)</span><br><span class="line">                .add(String.valueOf(StrPool.C_SPACE))</span><br><span class="line">                .add(String.valueOf(totalPageCount));</span><br><span class="line">        canvas.showTextAligned(p, x, y, TextAlignment.RIGHT);</span><br><span class="line">        pdfCanvas.addXObject(placeholder, x + space, y - descent);</span><br><span class="line">        pdfCanvas.release();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="水印"><a href="#水印" class="headerlink" title="水印"></a>水印</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 水印</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WaterMarkEventHandler</span> <span class="keyword">implements</span> <span class="title class_">IEventHandler</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 水印内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String waterMarkContent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 一页中有几列水印</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> waterMarkX;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 一页中每列有多少水印</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> waterMarkY;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WaterMarkEventHandler</span><span class="params">(String waterMarkContent)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>(waterMarkContent, <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WaterMarkEventHandler</span><span class="params">(String waterMarkContent, <span class="type">int</span> waterMarkX, <span class="type">int</span> waterMarkY)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.waterMarkContent = waterMarkContent;</span><br><span class="line">        <span class="built_in">this</span>.waterMarkX = waterMarkX;</span><br><span class="line">        <span class="built_in">this</span>.waterMarkY = waterMarkY;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleEvent</span><span class="params">(Event event)</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">PdfDocumentEvent</span> <span class="variable">documentEvent</span> <span class="operator">=</span> (PdfDocumentEvent) event;</span><br><span class="line">        <span class="type">PdfDocument</span> <span class="variable">document</span> <span class="operator">=</span> documentEvent.getDocument();</span><br><span class="line">        <span class="type">PdfPage</span> <span class="variable">page</span> <span class="operator">=</span> documentEvent.getPage();</span><br><span class="line">        <span class="type">Rectangle</span> <span class="variable">pageSize</span> <span class="operator">=</span> page.getPageSize();</span><br><span class="line"></span><br><span class="line">        <span class="type">PdfFont</span> <span class="variable">pdfFont</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            pdfFont = PdfFontFactory.createFont(<span class="string">&quot;STSongStd-Light&quot;</span>, <span class="string">&quot;UniGB-UCS2-H&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">PdfCanvas</span> <span class="variable">pdfCanvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfCanvas</span>(page.newContentStreamAfter(), page.getResources(), document);</span><br><span class="line"></span><br><span class="line">        <span class="type">Paragraph</span> <span class="variable">waterMark</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Paragraph</span>(waterMarkContent).setOpacity(<span class="number">0.5f</span>);</span><br><span class="line">        <span class="type">Canvas</span> <span class="variable">canvas</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Canvas</span>(pdfCanvas, pageSize)</span><br><span class="line">                .setFontColor(WebColors.getRGBColor(<span class="string">&quot;lightgray&quot;</span>))</span><br><span class="line">                .setFontSize(<span class="number">16</span>)</span><br><span class="line">                .setFont(pdfFont);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; waterMarkX; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; waterMarkY; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                canvas.showTextAligned(waterMark, (<span class="number">150</span> + i * <span class="number">300</span>), (<span class="number">160</span> + j * <span class="number">150</span>), document.getNumberOfPages(), TextAlignment.CENTER, VerticalAlignment.BOTTOM, <span class="number">120</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Utils"><a href="#Utils" class="headerlink" title="Utils"></a>Utils</h3><h4 id="FreeMarkerUtils"><a href="#FreeMarkerUtils" class="headerlink" title="FreeMarkerUtils"></a>FreeMarkerUtils</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FreeMarkerUtils</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Template <span class="title function_">getTemplate</span><span class="params">(String template_path, String templateFileName)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">Template</span> <span class="variable">template</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            configuration.setDirectoryForTemplateLoading(<span class="keyword">new</span> <span class="title class_">File</span>(template_path));</span><br><span class="line">            configuration.setObjectWrapper(<span class="keyword">new</span> <span class="title class_">DefaultObjectWrapper</span>());</span><br><span class="line">            configuration.setDefaultEncoding(<span class="string">&quot;UTF-8&quot;</span>);   <span class="comment">//设置编码格式</span></span><br><span class="line">            <span class="comment">//模板文件</span></span><br><span class="line">            template = configuration.getTemplate(templateFileName + <span class="string">&quot;.ftl&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">genteratorFile</span><span class="params">(Map&lt;String, Object&gt; input, String template_path, String templateFileName, String savePath, String fileName)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Template</span> <span class="variable">template</span> <span class="operator">=</span> getTemplate(template_path, templateFileName);</span><br><span class="line">        <span class="type">File</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(savePath);</span><br><span class="line">        <span class="keyword">if</span> (!filePath.exists()) &#123;</span><br><span class="line">            filePath.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> savePath + <span class="string">&quot;\\&quot;</span> + fileName;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            file.delete();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Writer</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writer = <span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filename), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            template.process(input, writer);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">genterator</span><span class="params">(Map&lt;String, Object&gt; variables, String template_path, String templateFileName)</span>  <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Template</span> <span class="variable">template</span> <span class="operator">=</span> getTemplate(template_path, templateFileName);</span><br><span class="line">        <span class="type">StringWriter</span> <span class="variable">stringWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringWriter</span>();</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(stringWriter);</span><br><span class="line">        template.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        template.process(variables, writer);</span><br><span class="line">        <span class="type">String</span> <span class="variable">htmlStr</span> <span class="operator">=</span> stringWriter.toString();</span><br><span class="line">        writer.flush();</span><br><span class="line">        writer.close();</span><br><span class="line">        <span class="keyword">return</span> htmlStr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="HtmlToPdfUtils"><a href="#HtmlToPdfUtils" class="headerlink" title="HtmlToPdfUtils"></a>HtmlToPdfUtils</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HtmlToPdfUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * html转pdf</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream  输入流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> waterMark    水印</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fontPath     字体路径，ttc后缀的字体需要添加&lt;b&gt;,0&lt;b/&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> : 2022/11/15 14:07</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">convertToPdf</span><span class="params">(InputStream inputStream, String waterMark, String fontPath, OutputStream outputStream)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 有两个pdfWriter和pdfDocument是因为为了解决这个页码的问题，</span></span><br><span class="line">        <span class="comment">// 原先页码是没办法获取到总的页码数量，经过一顿骚操作改造可以了，但是不知道会不会有隐藏风险</span></span><br><span class="line">        <span class="type">PdfWriter</span> <span class="variable">pdfWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfWriter</span>(outputStream);</span><br><span class="line">        <span class="type">PdfWriter</span> <span class="variable">pdfWriter1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfWriter</span>(outputStream);</span><br><span class="line">        <span class="type">PdfDocument</span> <span class="variable">pdfDocument</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfDocument</span>(pdfWriter);</span><br><span class="line">        <span class="type">PdfDocument</span> <span class="variable">pdfDocument1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfDocument</span>(pdfWriter1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置为A4大小并设置横向</span></span><br><span class="line"><span class="comment">//        PageSize pageSize = PageSize.A4.rotate();</span></span><br><span class="line">        pdfDocument.setDefaultPageSize(PageSize.A4.rotate());</span><br><span class="line">        pdfDocument1.setDefaultPageSize(PageSize.A4.rotate());</span><br><span class="line">        <span class="comment">// 如果是纵向就用下面这个</span></span><br><span class="line"><span class="comment">//        pdfDocument.setDefaultPageSize(PageSize.A4);</span></span><br><span class="line"><span class="comment">//        pdfDocument1.setDefaultPageSize(PageSize.A4);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加水印</span></span><br><span class="line">         pdfDocument.addEventHandler(PdfDocumentEvent.END_PAGE, <span class="keyword">new</span> <span class="title class_">WaterMarkEventHandler</span>(waterMark));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加中文字体支持</span></span><br><span class="line">        <span class="type">ConverterProperties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConverterProperties</span>();</span><br><span class="line">        <span class="type">FontProvider</span> <span class="variable">fontProvider</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FontProvider</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加自定义字体，</span></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(fontPath)) &#123;</span><br><span class="line">            <span class="comment">// 下面是使用的鸿蒙字体</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">HARMONYOS_SANS_SC_REGULAR</span> <span class="operator">=</span> <span class="string">&quot;D:\\lot\\code\\study\\springboot-restful-starter\\src\\main\\resources\\fonts\\HARMONYOS_SANS_SC_REGULAR.TTF&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">HARMONYOS_SANS_SC_BOLD</span> <span class="operator">=</span> <span class="string">&quot;D:\\lot\\code\\study\\springboot-restful-starter\\src\\main\\resources\\fonts\\HARMONYOS_SANS_SC_BOLD.TTF&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">HARMONYOS_SANS_SC_BLACK</span> <span class="operator">=</span> <span class="string">&quot;D:\\lot\\code\\study\\springboot-restful-starter\\src\\main\\resources\\fonts\\HARMONYOS_SANS_SC_BLACK.TTF&quot;</span>;</span><br><span class="line">            <span class="type">PdfFont</span> <span class="variable">ttfFontOne</span> <span class="operator">=</span> PdfFontFactory.createFont(HARMONYOS_SANS_SC_REGULAR, PdfEncodings.IDENTITY_H, <span class="literal">false</span>);</span><br><span class="line">            <span class="type">PdfFont</span> <span class="variable">ttfFontTwo</span> <span class="operator">=</span> PdfFontFactory.createFont(HARMONYOS_SANS_SC_BOLD, PdfEncodings.IDENTITY_H, <span class="literal">false</span>);</span><br><span class="line">            <span class="type">PdfFont</span> <span class="variable">ttfFontThird</span> <span class="operator">=</span> PdfFontFactory.createFont(HARMONYOS_SANS_SC_BLACK, PdfEncodings.IDENTITY_H, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            fontProvider.addFont(ttfFontOne.getFontProgram());</span><br><span class="line">            fontProvider.addFont(ttfFontTwo.getFontProgram());</span><br><span class="line">            fontProvider.addFont(ttfFontThird.getFontProgram());</span><br><span class="line">            properties.setFontProvider(fontProvider);</span><br><span class="line">            properties.setCharset(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        properties.setFontProvider(fontProvider);</span><br><span class="line">        <span class="comment">// 读取Html文件流，查找出当中的&amp;nbsp;或出现类似的符号空格字符</span></span><br><span class="line">        Map&lt;String, Object&gt; map = readInputStrem(inputStream);</span><br><span class="line">        <span class="comment">// 需要先生成document，而不是直接生成pdf文件（因直接生成pdf文件会关闭流）</span></span><br><span class="line">        <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> HtmlConverter.convertToDocument((String) map.get(<span class="string">&quot;html&quot;</span>), pdfDocument1, properties);</span><br><span class="line"></span><br><span class="line">        document.flush();</span><br><span class="line">        <span class="type">PageXofY</span> <span class="variable">event</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageXofY</span>(pdfDocument, document.getPdfDocument().getNumberOfPages());</span><br><span class="line"></span><br><span class="line">        pdfDocument.addEventHandler(PdfDocumentEvent.END_PAGE, event);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        inputStream = (InputStream) map.get(<span class="string">&quot;inputStream&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (inputStream != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 生成pdf文档</span></span><br><span class="line">                HtmlConverter.convertToPdf(inputStream, pdfDocument, properties);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                log.error(<span class="string">&quot;转换失败！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                pdfWriter.close();</span><br><span class="line">                pdfDocument.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取HTML 流文件，并查询当中的&amp;nbsp;或类似符号直接替换为空格</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">readInputStrem</span><span class="params">(InputStream inputStream)</span> &#123;</span><br><span class="line">        HashMap&lt;String, Object&gt; returnMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 定义一些特殊字符的正则表达式 如：</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">regEx_special</span> <span class="operator">=</span> <span class="string">&quot;\\&amp;[a-zA-Z]&#123;1,10&#125;;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//&lt;1&gt;创建字节数组输出流，用来输出读取到的内容</span></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="comment">//&lt;2&gt;创建缓存大小</span></span><br><span class="line">            <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>]; <span class="comment">// 1KB</span></span><br><span class="line">            <span class="comment">//每次读取到内容的长度</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="comment">//&lt;3&gt;开始读取输入流中的内容</span></span><br><span class="line">            <span class="keyword">while</span> ((len = inputStream.read(buffer)) != -<span class="number">1</span>) &#123; <span class="comment">//当等于-1说明没有数据可以读取了</span></span><br><span class="line">                baos.write(buffer, <span class="number">0</span>, len);   <span class="comment">//把读取到的内容写到输出流中</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//&lt;4&gt; 把字节数组转换为字符串</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> baos.toString();</span><br><span class="line">            <span class="comment">//&lt;5&gt;关闭输入流和输出流</span></span><br><span class="line">            <span class="comment">//            inputStream.close();</span></span><br><span class="line">            baos.close();</span><br><span class="line">            <span class="comment">//            log.info(&quot;读取的内容：&#123;&#125;&quot;, content);</span></span><br><span class="line">            <span class="comment">//            判断HTML内容是否具有HTML的特殊字符标记</span></span><br><span class="line">            <span class="type">Pattern</span> <span class="variable">compile</span> <span class="operator">=</span> Pattern.compile(regEx_special, Pattern.CASE_INSENSITIVE);</span><br><span class="line">            <span class="type">Matcher</span> <span class="variable">matcher</span> <span class="operator">=</span> compile.matcher(content);</span><br><span class="line">            <span class="type">String</span> <span class="variable">replaceAll</span> <span class="operator">=</span> matcher.replaceAll(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//            log.info(&quot;替换后的内容：&#123;&#125;&quot;, replaceAll);</span></span><br><span class="line">            <span class="comment">//            将字符串转化为输入流返回</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">stringStream</span> <span class="operator">=</span> getStringStream(replaceAll);</span><br><span class="line">            returnMap.put(<span class="string">&quot;inputStream&quot;</span>, stringStream);</span><br><span class="line">            returnMap.put(<span class="string">&quot;html&quot;</span>, replaceAll);</span><br><span class="line">            <span class="comment">//&lt;6&gt;返回结果</span></span><br><span class="line">            <span class="keyword">return</span> returnMap;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.error(<span class="string">&quot;错误信息：&#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将一个字符串转化为输入流</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sInputString 字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> InputStream <span class="title function_">getStringStream</span><span class="params">(String sInputString)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (sInputString != <span class="literal">null</span> &amp;&amp; !sInputString.trim().equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ByteArrayInputStream</span> <span class="variable">tInputStringStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(sInputString.getBytes());</span><br><span class="line">                <span class="keyword">return</span> tInputStringStream;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="测试类"><a href="#测试类" class="headerlink" title="测试类"></a>测试类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestHtmlToPdf</span> &#123;</span><br><span class="line">    <span class="comment">// 模板路径</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">TEMP</span> <span class="operator">=</span> <span class="string">&quot;D:\\lot\\code\\study\\springboot-restful-starter\\src\\main\\resources\\templates\\&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模板所需的数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 从数据库中获取数据， 出于演示目的， 这里数据不从数据库获取， 而是直接写死</span></span><br><span class="line">        <span class="type">Map</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        input.put(<span class="string">&quot;title&quot;</span>, <span class="string">&quot;测试title&quot;</span>);</span><br><span class="line">        input.put(<span class="string">&quot;logo&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        input.put(<span class="string">&quot;accountId&quot;</span>, <span class="string">&quot;MC&quot;</span> + UUID.randomUUID(<span class="literal">false</span>));</span><br><span class="line">        input.put(<span class="string">&quot;accountName&quot;</span>, <span class="string">&quot;MC&quot;</span> + UUID.randomUUID(<span class="literal">false</span>));</span><br><span class="line">        input.put(<span class="string">&quot;dateOfIssue&quot;</span>, DateUtil.now());</span><br><span class="line">        List&lt;Map&lt;String, String&gt;&gt; tableData = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Map&lt;String, String&gt; rowData = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            rowData.put(<span class="string">&quot;tableData1&quot;</span>, <span class="string">&quot;这是第&quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot;行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据&quot;</span>);</span><br><span class="line">            rowData.put(<span class="string">&quot;tableData2&quot;</span>, <span class="string">&quot;这是第&quot;</span> + (i + <span class="number">1</span>) + <span class="string">&quot;行的第二个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据行的第一个表格数据&quot;</span>);</span><br><span class="line">            tableData.add(rowData);</span><br><span class="line">        &#125;</span><br><span class="line">        input.put(<span class="string">&quot;tableData&quot;</span>, tableData);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        input.put(<span class="string">&quot;accountId&quot;</span>, UUID.randomUUID());</span><br><span class="line">        input.put(<span class="string">&quot;DateOfIssue&quot;</span>, DateUtil.today());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 准备美国人的姓和名的数组</span></span><br><span class="line">        String[] firstNames = &#123;<span class="string">&quot;James&quot;</span>, <span class="string">&quot;John&quot;</span>, <span class="string">&quot;Robert&quot;</span>, <span class="string">&quot;Michael&quot;</span>, <span class="string">&quot;William&quot;</span>&#125;;</span><br><span class="line">        String[] lastNames = &#123;<span class="string">&quot;Smith&quot;</span>, <span class="string">&quot;Johnson&quot;</span>, <span class="string">&quot;Williams&quot;</span>, <span class="string">&quot;Jones&quot;</span>, <span class="string">&quot;Brown&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用RandomUtil随机选择姓和名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">randomFirstName</span> <span class="operator">=</span> RandomUtil.randomEle(firstNames);</span><br><span class="line">        <span class="type">String</span> <span class="variable">randomLastName</span> <span class="operator">=</span> RandomUtil.randomEle(lastNames);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 组合姓名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fullName</span> <span class="operator">=</span> randomFirstName + <span class="string">&quot; &quot;</span> + randomLastName;</span><br><span class="line">        input.put(<span class="string">&quot;accountName&quot;</span>, fullName);</span><br><span class="line"></span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; rows = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">double</span> <span class="variable">y</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">500</span>; i++) &#123;</span><br><span class="line">            <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">            <span class="type">DecimalFormat</span> <span class="variable">df</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;#.##&quot;</span>);</span><br><span class="line">            String[] currencyArr = &#123;<span class="string">&quot;USD&quot;</span>, <span class="string">&quot;CNY&quot;</span>, <span class="string">&quot;EURO&quot;</span>&#125;;</span><br><span class="line">            String[] platformArr = &#123;<span class="string">&quot;Shopify&quot;</span>, <span class="string">&quot;WooCommerce&quot;</span>, <span class="string">&quot;Magento&quot;</span>&#125;;</span><br><span class="line">            String[] shipArr = &#123;<span class="string">&quot;AFL SHIPPING&quot;</span>, <span class="string">&quot;BFL SHIPPING&quot;</span>, <span class="string">&quot;CFL SHIPPING&quot;</span>&#125;;</span><br><span class="line">            String[] typeArr = &#123;<span class="string">&quot;Deposit&quot;</span>, <span class="string">&quot;Withdraw&quot;</span>, <span class="string">&quot;Refund&quot;</span>&#125;;</span><br><span class="line">            <span class="type">int</span> <span class="variable">minAmount</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">maxAmount</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="type">String</span> <span class="variable">date</span> <span class="operator">=</span> <span class="string">&quot;2024-04-&quot;</span> + r.nextInt(<span class="number">30</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">demo1</span> <span class="operator">=</span> <span class="string">&quot;DemoDemoDemoDemoDemoDemoDemo&quot;</span> + RandomUtil.randomNumbers(<span class="number">10</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">demo2</span> <span class="operator">=</span> <span class="string">&quot;Demo&quot;</span> + RandomUtil.randomNumbers(Integer.valueOf(RandomUtil.randomNumbers(<span class="number">1</span>)));</span><br><span class="line">            <span class="type">String</span> <span class="variable">accNumber</span> <span class="operator">=</span> String.valueOf(r.nextLong()).substring(<span class="number">1</span>, <span class="number">14</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">currency</span> <span class="operator">=</span> currencyArr[r.nextInt(currencyArr.length)];</span><br><span class="line">            <span class="type">String</span> <span class="variable">platform</span> <span class="operator">=</span> platformArr[r.nextInt(platformArr.length)];</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Ma Wang&quot;</span> + RandomUtil.randomNumbers(<span class="number">10</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">ship</span> <span class="operator">=</span> shipArr[r.nextInt(shipArr.length)];</span><br><span class="line">            <span class="type">String</span> <span class="variable">quantity</span> <span class="operator">=</span> String.valueOf(r.nextInt(<span class="number">30</span>));</span><br><span class="line">            <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> typeArr[r.nextInt(typeArr.length)];</span><br><span class="line">            <span class="type">String</span> <span class="variable">amount</span> <span class="operator">=</span> df.format(minAmount + (maxAmount - minAmount) * r.nextDouble());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Map&lt;String, Object&gt; row = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            row.put(<span class="string">&quot;y&quot;</span>, y);</span><br><span class="line">            row.put(<span class="string">&quot;part1&quot;</span>, date);</span><br><span class="line">            row.put(<span class="string">&quot;part2&quot;</span>, demo1);</span><br><span class="line">            row.put(<span class="string">&quot;part3&quot;</span>, demo2);</span><br><span class="line">            row.put(<span class="string">&quot;part4&quot;</span>, accNumber);</span><br><span class="line">            row.put(<span class="string">&quot;part5&quot;</span>, currency);</span><br><span class="line">            row.put(<span class="string">&quot;part6&quot;</span>, platform);</span><br><span class="line">            row.put(<span class="string">&quot;part7&quot;</span>, name);</span><br><span class="line">            row.put(<span class="string">&quot;part8&quot;</span>, ship);</span><br><span class="line">            row.put(<span class="string">&quot;part10&quot;</span>, currency);</span><br><span class="line">            row.put(<span class="string">&quot;part11&quot;</span>, quantity);</span><br><span class="line">            row.put(<span class="string">&quot;part12&quot;</span>, currency);</span><br><span class="line">            row.put(<span class="string">&quot;part13&quot;</span>, amount);</span><br><span class="line">            row.put(<span class="string">&quot;part9&quot;</span>, type);</span><br><span class="line">            rows.add(row);</span><br><span class="line">            y += <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        input.put(<span class="string">&quot;rows&quot;</span>, rows);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> input;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        extracted(<span class="string">&quot;thread-12&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">extracted</span><span class="params">(String filename)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">        <span class="comment">// 指定模板渲染值并生成html文件至指定位置</span></span><br><span class="line">        FreeMarkerUtils.genteratorFile(getContent(),</span><br><span class="line">                TEMP,</span><br><span class="line">                temp,</span><br><span class="line">                TEMP,</span><br><span class="line">                temp + <span class="string">&quot;.html&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 需转换的html文件名称</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">htmlFile</span> <span class="operator">=</span> temp + <span class="string">&quot;.html&quot;</span>;</span><br><span class="line">        <span class="comment">// 转换好pdf存储名称</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">pdfFile</span> <span class="operator">=</span> filename + <span class="string">&quot;.pdf&quot;</span>;</span><br><span class="line">        <span class="comment">// 自定义水印</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">waterMarkText</span> <span class="operator">=</span> <span class="string">&quot;JYX&quot;</span>;</span><br><span class="line">        <span class="comment">// 读取需转换的html文件</span></span><br><span class="line">        <span class="comment">// 读取需转换的html文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(TEMP + htmlFile);</span><br><span class="line">        <span class="comment">// 写出pdf存储位置</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(TEMP + pdfFile);</span><br><span class="line">        <span class="type">String</span> <span class="variable">FONT_TTF_PATH</span> <span class="operator">=</span> <span class="string">&quot;D:\\lot\\code\\springboot-restful-starter\\src\\main\\resources\\fonts\\HARMONYOS_SANS_SC_REGULAR.TTF&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始转换html生成pdf文档</span></span><br><span class="line">        HtmlToPdfUtils.convertToPdf(inputStream, waterMarkText, FONT_TTF_PATH, outputStream);</span><br><span class="line">        log.info(<span class="string">&quot;转换结束，耗时：&#123;&#125;ms&quot;</span>, System.currentTimeMillis() - startTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .a4-wrapper &#123;</span><br><span class="line">            width: 297mm;</span><br><span class="line">            height: 210mm;</span><br><span class="line">            padding: 20mm;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">            background: white;</span><br><span class="line">        &#125;</span><br><span class="line">        body &#123;</span><br><span class="line">            margin: 20px;</span><br><span class="line">            font-family: Arial, sans-serif;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        table &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            border-collapse: collapse;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        th &#123;</span><br><span class="line">            border-bottom: 1px solid #d3d3d3;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            text-align: left;</span><br><span class="line">            margin-bottom: 20px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        td &#123;</span><br><span class="line">            border: none;</span><br><span class="line">            padding: 10px;</span><br><span class="line">            text-align: left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .logo &#123;</span><br><span class="line">            display: block;</span><br><span class="line">            margin-left: auto;</span><br><span class="line">            margin-right: auto;</span><br><span class="line">            width: 50%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .title &#123;</span><br><span class="line">            text-align: center;</span><br><span class="line">            margin-bottom: 20px;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .account-info &#123;</span><br><span class="line">            margin-left: 10%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .date &#123;</span><br><span class="line">            margin-right: 10%;</span><br><span class="line">            text-align: right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .page &#123;</span><br><span class="line">            page-break-after: always;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;account-info&quot;&gt;</span><br><span class="line">        &lt;img src=&quot;$&#123;logo!&quot;#&quot;&#125;&quot; class=&quot;logo&quot; alt=&quot;Logo&quot;/&gt;</span><br><span class="line">        &lt;h1 class=&quot;title&quot;&gt;$&#123;title!&quot;Title&quot;&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;p&gt;Account ID: $&#123;accountId!&quot;#&quot;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;Account Name: $&#123;accountName!&quot;#&quot;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;date&quot;&gt;</span><br><span class="line">        &lt;p&gt;Date of issue: $&#123;dateOfIssue!&quot;#&quot;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;固定表头1&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;固定表头2&lt;/th&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line">    &lt;#list tableData as row&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td style=&quot;word-break: break-all; max-width: 100px;&quot;&gt;$&#123;row.tableData1&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td style=&quot;word-break: break-all; max-width: 100px;&quot;&gt;$&#123;row.tableData2&#125;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/#list&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

        </div>
          
        <div class="top-div">
          <ol class="top-box"><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82"><span class="top-box-text">业务需求</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#%E6%95%99%E7%A8%8B"><span class="top-box-text">教程</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%87%86%E5%A4%87"><span class="top-box-text">准备</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#POM%E4%BE%9D%E8%B5%96"><span class="top-box-text">POM依赖</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#Handler"><span class="top-box-text">Handler</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E6%B0%B4%E5%8D%B0"><span class="top-box-text">水印</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#Utils"><span class="top-box-text">Utils</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#HtmlToPdfUtils"><span class="top-box-text">HtmlToPdfUtils</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="top-box-text">测试类</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E6%A8%A1%E6%9D%BF"><span class="top-box-text">模板</span></a></li></ol></li></ol>
        </div>
          
      </div>
    </div>

    
      <div class="next-post">
        <a class="purple-link" href="/p/cee62a0f.html">
          <h3 class="post-title">
            下一篇：vue3的el-form表单输入响应式失效问题（input、单选都无法操作）
          </h3>
        </a>
      </div>
    
  </div>


    <div id="gitalk-container"></div>






<script>
    (function () {
        const jq = document.createElement('script');
        jq.src = "/js/twikoo.min.js";
        document.getElementsByTagName('body')[0].appendChild(jq);

        const config = {"envId":"https://wwtk-twikoo-o74lzzq47-zixingyx-gmailcom.vercel.app","region":null,"mark":null};
        jq.onload = function () {
            twikoo.init({
                envId: config.envId,
                el: '#gitalk-container',
                region: config.region,
                path: location.pathname + (config.mark ? '?mark=' + config.mark : ''),
                lang: config.language,
            });
        }
    })()
</script>




<footer>
<div class="site-footer">
  <div class="social-container">
    
      
        <a aria-label="跳转至github" href="https://github.com/paopao233" target="_blank">
          <i class="icon icon-github"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
  
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <a href="https://github.com/f-dong/hexo-theme-minimalism" target="_blank">Theme</a>
  
  
  
  
  
  
</div>
</footer>


      </div>
    </div>
    
<script id="hexo-configurations"> window.theme_config = {"image":{"lazyload_enable":true,"photo_zoom":"simple-lightbox"}}; window.is_post = true; </script>

<script src="/js/main.js"></script>






  <script src="/js/simple-lightbox.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {new SimpleLightbox('.post-detail .simple-lightbox', {fileExt: false,captionsData:'alt'});});</script></body>
</html>

